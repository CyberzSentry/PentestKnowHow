# Public reconnaissance
This checklist will help you gather the most information about your target from publicly available sources. Some techniques can overlap and gather similar types of infomration - this does not mean that they can be ommited as they might provide complementary data.

Do not approach this checklist as a list of steps to perform. Look at the obtained results and analyze them. It might be usefull to go back and perform some steps again with new data.

## DNS
Find all domains and subdomains connected to the target. Some of the tools alow for configuration of additional sources with the use of API keys. It is always best to use those as some can be accessed with a free account.

- [ ] [dnsdumpster](dnsdumpster.com)
- [ ] [SecurityTrails](https://securitytrails.com/)
- [ ] [amass](https://github.com/OWASP/Amass) - eg. `amass enum -v -src -ip -brute -min-for-recursive 2 -d example.com`
- [ ] [subfinder](https://github.com/projectdiscovery/subfinder) - eg. `subfinder -recursive -d example.com`
- [ ] [assetfinder](https://github.com/tomnomnom/assetfinder) - eg. `assetfinder [--subs-only] <domain>`
- [ ] [dnsgen](https://github.com/ProjectAnte/dnsgen) and [massdns](https://github.com/blechschmidt/massdns) - eg. `cat domains.txt | dnsgen - | massdns -r resolvers.txt -t A -o J --flush 2>/dev/null`

It is good to also run tools that check if discovered domains exist
- [ ] httprobe 
- [ ] aquatone - `cat domains.txt | aquatone -out ./outdir`

## Google dorks
Remember to modify to your target language. Don't treat them as a thing to hink about additional terms that can be added to search and use all discovered domains or domains with wildcards. 

Other usefull google dorks sources:
- [Google Hacking Database](https://www.exploit-db.com/google-hacking-database)
- https://github.com/InfuriousICC/Google-Dorks-Simplified#collection-of-most-useful-google-dorks

### Domains

- [ ] Subdomians `site:*.<domain> -site:www.<domain>`
- [ ] Sub-subdomains `site:*.*.<domain>`

### Pages

- [ ] Login `site:<domains> inurl:login | inurl:signin | intitle:Login | intitle:"sign in" | inurl:auth` 
- [ ] Signup `site:<domain> inurl:signup | inurl:register | intitle:Signup`
- [ ] SQL errors `site:<domains> intext:"sql syntax near" | intext:"syntax error has occurred" | intext:"incorrect syntax near" | intext:"unexpected end of SQL command" | intext:"Warning: mysql_connect()" | intext:"Warning: mysql_query()" | intext:"Warning: pg_connect()"`
- [ ] PHP errors `site:<domains> "PHP Parse error" | "PHP Warning" | "PHP Error"`
- [ ] phpinfo `site:<domains> ext:php intitle:phpinfo "published by the PHP Group"`

### Documents and files

- [ ] Documents `site:<domain> ext:doc | ext:docx | ext:odt | ext:rtf | ext:sxw | ext:psw | ext:ppt | ext:pptx | ext:pps | ext:csv`
- [ ] Directory listing `site:<domain> intitle:index.of`
- [ ] Configs `site:<domain> ext:xml | ext:conf | ext:cnf | ext:reg | ext:inf | ext:rdp | ext:cfg | ext:txt | ext:ora | ext:ini | ext:env`
- [ ] Database files `site:<domain> ext:sql | ext:dbf | ext:mdb`
- [ ] Log files `site:<domain> ext:log`
- [ ] Dackups and old files `site:<domain> ext:bkf | ext:bkp | ext:bak | ext:old | ext:backup`

### Code and secrets

- [ ] Pastebin & other `site:pastebin.com | site:paste2.org | site:pastehtml.com | site:slexy.org | site:snipplr.com | site:snipt.net | site:textsnip.com | site:bitpaste.app | site:justpaste.it | site:heypasteit.com | site:hastebin.com | site:dpaste.org | site:dpaste.com | site:codepad.org | site:jsitor.com | site:codepen.io | site:jsfiddle.net | site:dotnetfiddle.net | site:phpfiddle.org | site:ide.geeksforgeeks.org | site:repl.it | site:ideone.com | site:paste.debian.net | site:paste.org | site:paste.org.ru | site:codebeautify.org  | site:codeshare.io | site:trello.com "<search term>"`
- [ ] Github and gitlab `site:github.com | site:gitlab.com "<search term>"`
- [ ] stackoverflow `site:stackoverflow.com "<search term>"`

## Wayback machine
https://archive.org/web/ - This website shows historical snapshots of public websites. It can help discover hidden features and provide a better understanding of the targeted system.

## Shodan
https://www.shodan.io/ - Webcrawler and scanner. Can help with the discovery of interesting services without the need to perform intrusive scanning eg. nmap. The best way to find useful information is to search organization IP addresses. There are however usefull dorks that can speedup the process and help with the discovery of new targets eg:

- [ ] cert content: `ssl:<target>`
- [ ] Organization `org:<target>`
- [ ] Hostname `hostname:<domain>`
- [ ] Cert precise: `ssl.cert.subject.CN:"<domain>"`
- [ ] General `<target>`

You can download shodan results as json and extract values with the command:
`cat shodan.json| jq '.|"\(.product),\(.ip_str),\(.port),\(.hostnames[]),\(.location.country_code),\(has("http"))"'| sed 's/^"\(.*\)"$/\1/'`

Other sources:
- [Top Shodan Dorks](https://securitytrails.com/blog/top-shodan-dorks)
- [Git Shodan-Dorks](https://github.com/humblelad/Shodan-Dorks) 
- [Mr.k0anti-Shodan Dorks](https://mr-koanti.github.io/shodan#)

## Virtual Host Discovery

## Bypass CDN eg. Cloudflare
Content Deliver Networks hide real IP's of target systems and can partially filter trafic coming in and out of the installed services. It is always best to know the real IP of the target. There are multiple techniques that may help in the bypassing of those security mechanisms.

Previously discovered domains can be used with the found IP's to establish if  the host is running virtual hosts. Currently searching a tool that can help with the vhost to ip matching.

Following techniques can help with the identification of hidden IP's:

### [Shodan search](https://www.shodan.io/)
Shodan can help identify many target IP's and easly provide access to data about them. More info how to use shodan can be found in the [#Shodan](#Shodan) section.

- [ ] [SecurityTrails](https://securitytrails.com/)
- [ ] [Cloudfail](https://github.com/m0rtem/CloudFail)
- [ ] [Censys](https://search.censys.io/)
- [ ] [CrimeFlare](https://github.com/zidansec/CloudPeler)

### Bruteforce

Attempt bruteforcing of known domains against non-CDN IPs for example with the use of fuff `ffuf -w domains.txt -u http://<ip> -H "Host: FUZZ" `

## Final

After successfull initial enumeration of all attack surfaces it is good to take some additional steps to find all low hanging fruits.

- [ ] Run aquatone on all domains and hosts

# Sources

 - https://pentest-tools.com/information-gathering/google-hacking
 - https://www.exploit-db.com/google-hacking-database
 - https://medium.com/@hengky.kaiqi/finding-the-real-ip-address-of-a-website-behind-cloud-flare-c2115be8d163
 - https://securitytrails.com/blog/ip-address-behind-cloudflare
 - https://github.com/sehno/Bug-bounty/blob/master/bugbounty_checklist.md